webpackJsonp([8],{"1G+u":function(e,t,a){"use strict";var n=a("rQCC"),r=a("5b3W"),o=a.n(r);var s=function(e){a("OMds")},i=a("VU/8")(n.a,o.a,!1,s,"data-v-361849fa",null);t.a=i.exports},"39OJ":function(e,t,a){"use strict";var n=a("Cu/F");t.a=n.a},"5b3W":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"table-view-wrapper"},[a("el-table",{staticClass:"table",attrs:{data:e.tableData,stripe:"",border:""}},[e._t("default")],2),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.showPagination,expression:"showPagination"}],staticClass:"pagination",attrs:{background:!0,"current-page":e.pageMeta.page,"page-sizes":[10,20,30,50],"page-size":e.pageMeta.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]}},"5bZJ":function(e,t,a){var n=a("cjI8");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("660fcf00",n,!0,{})},BoP0:function(e,t,a){"use strict";var n=a("Fq0m"),r=a("reMk"),o=a("kIFb"),s=a("7+uW");t.a={format:function(t){if(t)return t.statusInfo=o.CONTRACT_STATUS_COLORS[t.status],t.forUsers=t.policySegment.users.map(function(e){return{users:e.users.join("、"),type:e.userType}}),t.partyOne&&Object(n.a)(t.partyOne).then(function(e){s.default.set(t,"partyOneInfo",e)}),t.partyTwo&&Object(r.a)(t.partyTwo).then(function(e){s.default.set(t,"partyTwoInfo",e)}),t}}},"Cu/F":function(e,t,a){"use strict";var n=a("pFYg"),r=a.n(n),o=a("woOf"),i=a.n(o),s=a("//Fk"),c=a.n(s),l=a("1G+u"),u=a("BoP0");t.a={name:"node-contracts",data:function(){return{resourceList:[],query:""}},components:{TableView:l.a},mounted:function(){},methods:{querySearchAsync:function(){},handleSelectSearchItem:function(){},queryHandler:function(){this.$message.warning("待开发")},loadResourceData:function(e){var t=this,a=e.map(function(e){return t.$services.resource.get(e).then(function(e){return e.getData()})});return c.a.all(a)},loadContracts:function(e){return this.$services.contract.get(e||{}).then(function(e){return e}).catch(this.$error.showErrorMessage)},loadPresentables:function(e){return this.$services.presentables.get({params:e}).then(function(e){return e.getData()}).catch(this.$error.showErrorMessage)},mergeDataByResourceId:function(e,t){var a={};t.forEach(function(e){a[e.resourceId]=e}),e.forEach(function(e){var t=a[e.resourceId]||null;t&&t.presentableId?i()(e,{presentableDetail:t}):t&&i()(e,{resourceDetail:t})})},loader:function(){var o=this,s=this;return function(e){var a=s.$route.params.nodeId;return"object"===(void 0===e?"undefined":r()(e))&&(i()(e,{partyTwo:a}),e={params:e}),s.loadContracts(e).then(function(n){var r=n.data.data.dataList,e=r.map(function(e){return u.a.format(e),e.contractId});if(!r.length)return n;var t=r.map(function(e){return e.resourceId});return c.a.all([o.loadResourceData(t),s.loadPresentables({contractIds:e.join(","),nodeId:a})]).then(function(e){var t=e[0],a=e[1];return s.mergeDataByResourceId(r,t),s.mergeDataByResourceId(r,a),n})})}},handlePresentable:function(e){var t=this.$route.params.nodeId;e.presentableDetail?this.$router.push({path:"/node/"+t+"/presentable/detail",query:{presentableId:e.presentableDetail.presentableId}}):this.$router.push({path:"/node/"+t+"/presentable/create",query:{contractId:e.contractId}})},previewHandler:function(e){var t={};e.presentableDetail?t.presentableId=e.presentableDetail.presentableId:t.contractId=e.contractId,this.$router.push({path:"/node/"+this.$route.params.nodeId+"/presentable/detail#contract",query:t})}}}},Fq0m:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("+vOg");function r(e){return n.UserService.get(e).then(function(e){return e.getData()})}},HmXb:function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("section",[n("el-input",{staticClass:"query-input",attrs:{placeholder:"请输入搜索内容"},model:{value:a.query,callback:function(e){a.query=e},expression:"query"}},[n("el-button",{attrs:{slot:"append",icon:"search",type:"primary"},on:{click:a.queryHandler},slot:"append"})],1),a._v(" "),n("table-view",{staticClass:"contracts-list",attrs:{loader:a.loader()}},[n("el-table-column",{attrs:{label:"资源名称"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n        "+a._s(e.row.resourceDetail.resourceName)+"\n        "),e.row.resourceDetail.systemMeta.version?n("span",{staticClass:"widget-version"},[a._v("v "+a._s(e.row.resourceDetail.systemMeta.version))]):a._e()]}}])}),a._v(" "),n("el-table-column",{attrs:{align:"center",prop:"contractId",label:"contractId"}}),a._v(" "),n("el-table-column",{attrs:{prop:"resourceId",label:"resourceId"}}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"资源作者"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.partyOneInfo?n("span",[a._v(a._s(e.row.partyOneInfo.nickname))]):a._e()]}}])}),a._v(" "),n("el-table-column",{attrs:{align:"center",label:"createDate"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v("\n        "+a._s(a._f("fmtDate")(e.row.createDate))+"\n      ")]}}])}),a._v(" "),n("el-table-column",{attrs:{width:"120px",align:"center",prop:"resourceDetail.resourceType",label:"resourceType"}}),a._v(" "),n("el-table-column",{attrs:{width:"100px",align:"center",label:"合同状态"},scopedSlots:a._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:e.row.statusInfo.type}},[a._v(a._s(e.row.statusInfo.desc))])]}}])}),a._v(" "),n("el-table-column",{attrs:{align:"center",width:"250px",label:"操作"},scopedSlots:a._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"small"},on:{click:function(e){a.previewHandler(t.row)}}},[a._v("查看详情")]),a._v(" "),n("el-button",{attrs:{size:"small"},on:{click:function(e){a.handlePresentable(t.row)}}},[a._v(a._s(t.row.presentableDetail?"查看presentable":"创建presentable"))])]}}])})],1)],1)},staticRenderFns:[]}},OMds:function(e,t,a){var n=a("rUtK");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("743cdafe",n,!0,{})},PG49:function(e,t,a){"use strict";var n=a("woOf"),r=a.n(n),o=a("kEHT");t.a={name:"table-view",data:function(){return{loading:!1,tableData:[],total:0}},props:{data:{type:Array,default:function(){return[]}},showPagination:{type:Boolean,default:!0},formatHandler:{type:Function,default:null},paginationOptions:{type:Object,default:function(){return{pageSizes:[10,20,30,50]}}},loader:Function,pageMeta:{type:Object,default:function(){var e=o.c.get("PAGE_"+this.$route.fullPath+"_index")||{};return r()({pageSize:10,page:1},e)}}},beforeDestroy:function(){this.pageMeta&&this.pageMeta.keyWords&&delete this.pageMeta.keyWords,o.c.set("PAGE_"+this.pageUrl+"_index",this.pageMeta)},mounted:function(){this.pageUrl=this.$route.fullPath,this.tableData=this.data,this.total=this.tableData.length,this.load(),this.$on("reload",this.reload.bind(this))},methods:{reload:function(e){this.load(e)},load:function(e){var n=this;r()(this.pageMeta,e||{}),this.loader&&(this.loading=!0,this.loader(this.pageMeta).then(function(e){var t=e.getData();if(n.loading=!1,t){var a=t.dataList||t;n.formatHandler&&(a=n.formatHandler(a)),n.tableData=a,t.dataList?(n.total=t.totalItem,n.pageMeta.page=t.page||1):n.total=a.length}else n.$message.error(t.msg)}).catch(function(e){n.$message.warning("加载失败"),n.loading=!1}))},handleSizeChange:function(e){var t={pageSize:e};this.load(t),this.$emit("sizeChange",t)},handleCurrentChange:function(e){var t={page:e};this.load(t),this.$emit("pageChange",t)}}}},cjI8:function(e,t,a){(e.exports=a("FZ+f")(!0)).push([e.i,".query-input[data-v-0e3ba19e]{margin-bottom:15px;width:50%}.resource-list[data-v-0e3ba19e]{width:100%;min-height:600px}","",{version:3,sources:["/Users/daizecheng/workplace/freelog/console.freelog.com/client/src/views/node/contract/list/index.vue"],names:[],mappings:"AACA,8BACE,mBAAoB,AACpB,SAAW,CACZ,AACD,gCACE,WAAY,AACZ,gBAAkB,CACnB",file:"index.vue",sourcesContent:["\n.query-input[data-v-0e3ba19e] {\n  margin-bottom: 15px;\n  width: 50%;\n}\n.resource-list[data-v-0e3ba19e] {\n  width: 100%;\n  min-height: 600px;\n}\n"],sourceRoot:""}])},kIFb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a.d(t,"CONTRACT_STATUS",function(){return n}),a.d(t,"CONTRACT_STATUS_TIPS",function(){return r}),a.d(t,"CONTRACT_STATUS_COLORS",function(){return o});var n={uncreated:-1,initial:1,running:2,activated:3,userTerminated:4,sysTerminated:5,terminated:6},r={"-1":"未创建合同",1:"未开始执行",2:"执行中",3:"生效中",4:"用户终止",5:"系统终止",6:"合同已终止"},o={"-1":{type:"danger",desc:"未创建合同"},1:{type:"warning",desc:"未开始执行"},2:{type:"warning",desc:"执行中"},3:{type:"success",desc:"生效中"},4:{type:"info",desc:"用户终止"},5:{type:"info",desc:"系统终止"},6:{type:"info",desc:"合同已终止"}}},qsGF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("39OJ"),r=a("HmXb"),o=a.n(r);var s=function(e){a("5bZJ")},i=a("VU/8")(n.a,o.a,!1,s,"data-v-0e3ba19e",null);t.default=i.exports},rQCC:function(e,t,a){"use strict";var n=a("PG49");t.a=n.a},rUtK:function(e,t,a){(e.exports=a("FZ+f")(!0)).push([e.i,".table-view-wrapper .table[data-v-361849fa]{max-height:100%}.table-view-wrapper .pagination[data-v-361849fa]{margin-top:15px;text-align:center}","",{version:3,sources:["/Users/daizecheng/workplace/freelog/console.freelog.com/client/src/components/TableView/index.vue"],names:[],mappings:"AACA,4CACE,eAAiB,CAClB,AACD,iDACE,gBAAiB,AACjB,iBAAmB,CACpB",file:"index.vue",sourcesContent:["\n.table-view-wrapper .table[data-v-361849fa] {\n  max-height: 100%;\n}\n.table-view-wrapper .pagination[data-v-361849fa] {\n  margin-top: 15px;\n  text-align: center;\n}\n"],sourceRoot:""}])},reMk:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("+vOg");function r(e){return n.NodesService.get(e).then(function(e){return e.getData()})}}});